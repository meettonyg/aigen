<?php\n/**\n * AJAX Endpoints Debug Script\n * Run this to verify AJAX handlers are properly registered\n */\n\n// WordPress debug script - place in your plugin directory\nif (!defined('ABSPATH')) {\n    // If running outside WordPress, define basic constants\n    define('ABSPATH', dirname(dirname(dirname(dirname(__FILE__)))) . '/');\n}\n\n// Include WordPress if not already loaded\nif (!function_exists('wp_ajax_mkcg_save_authority_hook')) {\n    require_once(ABSPATH . 'wp-config.php');\n}\n\necho \"<h1>üîß AJAX Endpoints Debug</h1>\";\necho \"<style>body{font-family:Arial;margin:20px;} .pass{color:green;} .fail{color:red;} .warn{color:orange;} pre{background:#f5f5f5;padding:10px;border-radius:4px;}</style>\";\n\n// Check if WordPress functions are available\nif (!function_exists('has_action')) {\n    echo \"<p class='fail'>‚ùå WordPress not loaded properly</p>\";\n    exit;\n}\n\necho \"<h2>üìã AJAX Action Registration Check</h2>\";\n\n// List of AJAX actions that should be registered\n$required_ajax_actions = [\n    'wp_ajax_mkcg_save_authority_hook',\n    'wp_ajax_nopriv_mkcg_save_authority_hook',\n    'wp_ajax_mkcg_save_field', \n    'wp_ajax_nopriv_mkcg_save_field',\n    'wp_ajax_mkcg_save_topic_field',\n    'wp_ajax_nopriv_mkcg_save_topic_field',\n    'wp_ajax_mkcg_get_topics_data',\n    'wp_ajax_nopriv_mkcg_get_topics_data',\n    'wp_ajax_generate_interview_topics',\n    'wp_ajax_nopriv_generate_interview_topics'\n];\n\necho \"<table border='1' cellpadding='5' cellspacing='0' style='border-collapse:collapse;'>\";\necho \"<tr><th>AJAX Action</th><th>Status</th><th>Handler</th></tr>\";\n\n$registered_count = 0;\n$total_count = count($required_ajax_actions);\n\nforeach ($required_ajax_actions as $action) {\n    $callback = has_action($action);\n    \n    if ($callback) {\n        echo \"<tr><td>$action</td><td class='pass'>‚úÖ Registered</td><td><pre>\" . print_r($callback, true) . \"</pre></td></tr>\";\n        $registered_count++;\n    } else {\n        echo \"<tr><td>$action</td><td class='fail'>‚ùå Missing</td><td>-</td></tr>\";\n    }\n}\n\necho \"</table>\";\n\necho \"<h2>üìä Summary</h2>\";\nif ($registered_count === $total_count) {\n    echo \"<p class='pass'>‚úÖ All $total_count AJAX endpoints are properly registered!</p>\";\n    echo \"<p><strong>Result:</strong> AJAX save errors should be fixed.</p>\";\n} else {\n    echo \"<p class='fail'>‚ùå Only $registered_count of $total_count AJAX endpoints are registered.</p>\";\n    echo \"<p><strong>Action Required:</strong> Make sure the Topics Generator is properly initialized.</p>\";\n}\n\necho \"<h2>üîç WordPress Environment Check</h2>\";\necho \"<ul>\";\necho \"<li>WordPress loaded: \" . (function_exists('wp_ajax_mkcg_save_authority_hook') ? \"<span class='pass'>‚úÖ Yes</span>\" : \"<span class='fail'>‚ùå No</span>\") . \"</li>\";\necho \"<li>ABSPATH: \" . ABSPATH . \"</li>\";\necho \"<li>Current URL: \" . $_SERVER['REQUEST_URI'] . \"</li>\";\necho \"<li>Plugin directory: \" . (defined('MKCG_PLUGIN_PATH') ? MKCG_PLUGIN_PATH : '<span class=\"warn\">‚ö†Ô∏è Not defined</span>') . \"</li>\";\necho \"</ul>\";\n\necho \"<h2>üß™ Manual Test Instructions</h2>\";\necho \"<ol>\";\necho \"<li><strong>Go to:</strong> <code>yoursite.com/topics/?frm_action=edit&entry=y8ver</code></li>\";\necho \"<li><strong>Open browser console</strong> (F12)</li>\";\necho \"<li><strong>Click 'Edit Components'</strong></li>\";\necho \"<li><strong>Type in any authority hook field</strong></li>\";\necho \"<li><strong>Check console:</strong> Should see 'Authority hook components saved successfully'</li>\";\necho \"<li><strong>Check network tab:</strong> Should see successful 200 responses, not 400/500 errors</li>\";\necho \"</ol>\";\n\necho \"<h2>üìù Troubleshooting</h2>\";\necho \"<div style='background:#ffebee;padding:15px;border-radius:4px;'>\";\necho \"<p><strong>If endpoints are missing:</strong></p>\";\necho \"<ul>\";\necho \"<li>Make sure Topics Generator is initialized: <code>\\$mkcg_topics_generator->init()</code></li>\";\necho \"<li>Check if class exists: <code>class_exists('MKCG_Topics_Generator')</code></li>\";\necho \"<li>Verify WordPress hooks are running properly</li>\";\necho \"</ul>\";\necho \"<p><strong>If still getting errors:</strong></p>\";\necho \"<ul>\";\necho \"<li>Check WordPress error logs for PHP errors</li>\";\necho \"<li>Verify nonce validation is passing</li>\";\necho \"<li>Ensure Formidable service is available</li>\";\necho \"</ul>\";\necho \"</div>\";\n\n// Test basic WordPress AJAX functionality\necho \"<h2>üéØ WordPress AJAX Test</h2>\";\nif (defined('DOING_AJAX') && DOING_AJAX) {\n    echo \"<p class='pass'>‚úÖ Running in AJAX context</p>\";\n} else {\n    echo \"<p class='warn'>‚ö†Ô∏è Not running in AJAX context (this is normal for debug script)</p>\";\n}\n\necho \"<p><strong>Admin AJAX URL:</strong> \" . admin_url('admin-ajax.php') . \"</p>\";\necho \"<p><strong>Test URL:</strong> <a href='\" . admin_url('admin-ajax.php') . \"?action=mkcg_save_authority_hook' target='_blank'>Test mkcg_save_authority_hook</a> (should return error due to missing nonce, but endpoint should be found)</p>\";\n\n?>