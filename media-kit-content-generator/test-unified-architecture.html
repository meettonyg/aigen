<!DOCTYPE html>\n<html>\n<head>\n    <title>Unified Data Architecture Test</title>\n    <style>\n        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }\n        .test-container { max-width: 900px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }\n        .test-header { background: #2196F3; color: white; padding: 15px; margin: -20px -20px 20px; border-radius: 8px 8px 0 0; }\n        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 4px; }\n        .test-status { font-weight: bold; padding: 8px 12px; border-radius: 4px; margin: 5px 0; }\n        .status-pass { background: #4CAF50; color: white; }\n        .status-fail { background: #f44336; color: white; }\n        .status-improvement { background: #2196F3; color: white; }\n        .test-details { background: #f9f9f9; padding: 15px; margin: 10px 0; border-left: 4px solid #2196F3; font-family: monospace; font-size: 12px; line-height: 1.6; }\n        .architecture { background: #e3f2fd; padding: 15px; border-radius: 4px; margin: 20px 0; border: 2px solid #2196F3; }\n        .code-block { background: #263238; color: #ffffff; padding: 15px; border-radius: 4px; font-family: monospace; font-size: 12px; margin: 10px 0; overflow-x: auto; }\n        .priority { background: #fff3e0; padding: 10px; border-left: 4px solid #ff9800; margin: 10px 0; }\n    </style>\n</head>\n<body>\n    <div class=\"test-container\">\n        <div class=\"test-header\">\n            <h1>ğŸ—ï¸ Unified Data Architecture Implementation</h1>\n            <p>Testing the new centralized data approach for Topics and Questions Generators</p>\n        </div>\n\n        <div class=\"architecture\">\n            <h3>ğŸ¯ ARCHITECTURAL IMPROVEMENT</h3>\n            <p><strong>Previous Problem:</strong> Topics Generator and Questions Generator used different data sources and couldn't work together.</p>\n            <p><strong>New Solution:</strong> Unified data architecture with centralized data manager and cross-generator compatibility.</p>\n        </div>\n\n        <div class=\"test-section\">\n            <h3>ğŸ“Š Data Source Priority System</h3>\n            <p>The Questions Generator now uses a 3-tier priority system for data loading:</p>\n            \n            <div class=\"priority\">\n                <strong>ğŸ¥‡ PRIORITY 1: Centralized Data Manager</strong><br>\n                <code>MKCG_DataManager.getTopic(1-5)</code><br>\n                <em>Real-time synchronized data across all generators</em>\n            </div>\n            \n            <div class=\"priority\">\n                <strong>ğŸ¥ˆ PRIORITY 2: Topics Generator Shared Data</strong><br>\n                <code>window.MKCG_Topics_Data.topics</code><br>\n                <em>Direct data sharing when both generators on same page</em>\n            </div>\n            \n            <div class=\"priority\">\n                <strong>ğŸ¥‰ PRIORITY 3: Questions Generator Legacy Data</strong><br>\n                <code>MKCG_TopicsData</code><br>\n                <em>Backwards compatibility for existing implementations</em>\n            </div>\n        </div>\n\n        <div class=\"test-section\">\n            <h3>ğŸ”„ Real-Time Data Synchronization</h3>\n            <div class=\"test-details\">\nâœ… When Topics Generator updates a topic â†’ Centralized Data Manager updated\nâœ… When Questions Generator loads â†’ Gets latest data from centralized source\nâœ… Cross-generator communication via MKCG_DataManager\nâœ… Automatic fallback to shared page data if centralized unavailable\nâœ… Seamless integration when both generators on same page\n            </div>\n        </div>\n\n        <div class=\"test-section\">\n            <h3>ğŸ’» Implementation Example</h3>\n            <div class=\"code-block\">\n// NEW: Unified data loading with priority system\nloadUnifiedTopicsData: function() {\n    let dataSource = 'none';\n    let topicsFound = false;\n    \n    // PRIORITY 1: Centralized Data Manager\n    if (MKCG_DataManager) {\n        for (let i = 1; i <= 5; i++) {\n            const topicText = MKCG_DataManager.getTopic(i);\n            if (topicText) {\n                this.topicsData[i] = topicText;\n                topicsFound = true;\n            }\n        }\n        dataSource = 'centralized_data_manager';\n    }\n    \n    // PRIORITY 2: Topics Generator shared data\n    if (!topicsFound && window.MKCG_Topics_Data) {\n        // Convert format and sync to centralized manager\n        this.syncFromTopicsGenerator();\n        dataSource = 'topics_generator_shared';\n    }\n    \n    // PRIORITY 3: Legacy Questions Generator data\n    if (!topicsFound && MKCG_TopicsData) {\n        this.topicsData = MKCG_TopicsData;\n        dataSource = 'questions_generator_legacy';\n    }\n}\n            </div>\n        </div>\n\n        <div class=\"test-section\">\n            <h3>ğŸ§ª Testing Instructions</h3>\n            <ol>\n                <li><strong>Go to your Topics Generator page:</strong> <code>?entry=y8ver</code></li>\n                <li><strong>Open browser console</strong> (F12 â†’ Console tab)</li>\n                <li><strong>Look for new unified architecture messages:</strong></li>\n            </ol>\n            \n            <h4>âœ… Expected Console Output (NEW):</h4>\n            <div class=\"test-details\">\nâœ… \"MKCG Enhanced Questions: Initializing with unified data architecture\"\nâœ… \"MKCG Enhanced Questions: Loading from unified data architecture\"\nâœ… \"âœ… MKCG Questions: Loaded topics from Topics Generator (shared page)\"\nâœ… \"ğŸ”„ MKCG Questions: Synced Topics Generator data to Centralized Data Manager\"\nâœ… \"MKCG Enhanced Questions: Unified data loading complete\"\n            </div>\n            \n            <h4>âŒ Old Messages (SHOULD NOT SEE):</h4>\n            <div class=\"test-details\">\nâŒ \"MKCG Enhanced Questions: Skipping initialization - not on Questions Generator page\"\nâŒ \"MKCG Enhanced Questions: No topics data from PHP\"\nâŒ \"MKCG: Selected topic element not found\"\n            </div>\n        </div>\n\n        <div class=\"test-section\">\n            <h3>ğŸ” Architecture Benefits</h3>\n            \n            <div class=\"test-status status-improvement\">\n                âœ¨ CROSS-GENERATOR COMPATIBILITY\n            </div>\n            <p>Both generators can now work together on the same page sharing the same data source.</p>\n            \n            <div class=\"test-status status-improvement\">\n                âœ¨ REAL-TIME SYNCHRONIZATION\n            </div>\n            <p>Changes in Topics Generator are immediately available to Questions Generator via centralized data manager.</p>\n            \n            <div class=\"test-status status-improvement\">\n                âœ¨ INTELLIGENT FALLBACKS\n            </div>\n            <p>Priority-based data loading ensures data is found from the best available source.</p>\n            \n            <div class=\"test-status status-improvement\">\n                âœ¨ BACKWARDS COMPATIBILITY\n            </div>\n            <p>Existing implementations continue to work while gaining new capabilities.</p>\n        </div>\n\n        <div class=\"test-section\">\n            <h3>ğŸ“ˆ Data Flow Diagram</h3>\n            <div class=\"test-details\">\nTOPICS GENERATOR:\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    updates    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚   User edits    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  MKCG_DataManager   â”‚\nâ”‚     topic       â”‚               â”‚  (Centralized Hub)   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                           â”‚\n                                    syncs to â”‚\n                                           â–¼\nQUESTIONS GENERATOR:               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    reads      â”‚   Questions Gen      â”‚\nâ”‚  Loads topics   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   Topics Data        â”‚\nâ”‚  for questions  â”‚               â”‚   (Always Current)   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n            </div>\n        </div>\n\n        <div class=\"test-section\">\n            <h3>ğŸ¯ Success Criteria</h3>\n            \n            <div class=\"test-status status-pass\">\n                âœ… NO MORE \"Skipping initialization\" messages\n            </div>\n            \n            <div class=\"test-status status-pass\">\n                âœ… Questions Generator initializes on Topics pages\n            </div>\n            \n            <div class=\"test-status status-pass\">\n                âœ… Data automatically shared between generators\n            </div>\n            \n            <div class=\"test-status status-pass\">\n                âœ… Centralized data manager populated\n            </div>\n            \n            <div class=\"test-status status-pass\">\n                âœ… Clean console output with unified messages\n            </div>\n        </div>\n\n        <div class=\"test-section\">\n            <h3>ğŸš€ Future Possibilities</h3>\n            <p>With unified data architecture, we can now implement:</p>\n            <ul>\n                <li><strong>Real-time topic editing:</strong> Edit topics directly from Questions Generator</li>\n                <li><strong>Cross-generator workflows:</strong> Seamless transitions between generators</li>\n                <li><strong>Unified save operations:</strong> Save topics and questions simultaneously</li>\n                <li><strong>Data validation:</strong> Centralized validation across all generators</li>\n                <li><strong>Shared undo/redo:</strong> Consistent operation history</li>\n            </ul>\n        </div>\n\n        <div class=\"test-section\">\n            <h3>ğŸ“ Implementation Status</h3>\n            \n            <div class=\"test-status status-pass\">\n                âœ… Priority-based data loading implemented\n            </div>\n            \n            <div class=\"test-status status-pass\">\n                âœ… Cross-generator data synchronization implemented\n            </div>\n            \n            <div class=\"test-status status-pass\">\n                âœ… Unified initialization architecture implemented\n            </div>\n            \n            <div class=\"test-status status-pass\">\n                âœ… Backwards compatibility maintained\n            </div>\n            \n            <div class=\"test-status status-pass\">\n                âœ… Graceful error handling implemented\n            </div>\n        </div>\n    </div>\n\n    <script>\n        // Add some interactive testing functionality\n        function testDataArchitecture() {\n            if (typeof MKCG_DataManager !== 'undefined') {\n                console.log('ğŸ§ª Testing Centralized Data Manager:');\n                \n                // Test data retrieval\n                for (let i = 1; i <= 5; i++) {\n                    const topic = MKCG_DataManager.getTopic(i);\n                    console.log(`Topic ${i}:`, topic || 'No data');\n                }\n                \n                console.log('Data Manager State:', MKCG_DataManager.getState());\n            } else {\n                console.log('MKCG_DataManager not available on this page');\n            }\n            \n            if (typeof window.MKCG_Topics_Data !== 'undefined') {\n                console.log('ğŸ§ª Topics Generator Data:', window.MKCG_Topics_Data);\n            }\n            \n            if (typeof QuestionsGenerator !== 'undefined') {\n                console.log('ğŸ§ª Questions Generator State:', {\n                    topicsData: QuestionsGenerator.topicsData,\n                    selectedTopic: QuestionsGenerator.selectedTopicText,\n                    dataQuality: QuestionsGenerator.dataQuality\n                });\n            }\n        }\n        \n        // Auto-run test if generators are available\n        window.addEventListener('load', function() {\n            setTimeout(testDataArchitecture, 2000);\n        });\n    </script>\n</body>\n</html>